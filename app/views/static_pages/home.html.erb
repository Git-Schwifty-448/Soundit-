<% if logged_in? %>
    <% provide(:title, "Feed for " + current_user.name) %>
<% else %>
    <% provide(:title, "Feed") %>
<% end %>
<div class="row">
    <div class="col l10 offset-l1  m12 s12  ">
        <% if !logged_in? %>
           <div class="row">
                <div class="col l8 offset-l2 s12">
                    <span class="_title">
                        <i class="material-icons" style="font-size: 20px">cloud_queue</i>SoundIt!
                    </span>
                    <div class="row">
                        <div class="col m12 s12">
                            <div class="row">
                                <div class="col s12 content_card z-depth-1" style="padding-top: 5px; padding-bottom: 5px;">
                                    <span>
                                        SoundIt is a community always looking for new music. The concept is simple; sign up and contribute songs. Groups of songs then make up 
                                        communities. These communities can then be exported as playlists to your favorite music playform such as YouTube or Spotify. Alternatively
                                        users can create their own custom playlists and export them the same.<br><br>
                                        ~Enjoy,<br>
                                        The Quablex Team
                                    </span>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
           </div>
        <% end %>
<%# -- Trending Commuinities --------------------------------------------------- %>
        <div class="row">
            <div class="col s12">
                <div class="content_title">
                    <i class="material-icons" style="font-size: 35px">trending_up</i>Trending Communities
                </div>
                <div class="row">
                    <div class="col m12 s12">
                        <div class="row">
                            <% if @community_listings.length == 0 %>
                                <br>
                                <div class="col s12 content_card z-depth-1" style="padding: 10px;">
                                    <span class="_diamond">
                                        There are not any communities stored in the database. The first step should be to
                                        <%= link_to "create one.", new_community_path %>
                                    <span>
                                </div>
                            <% else %>
                                <% for com in @community_listings %>
                                    <%= render partial: "static_pages/topcom", locals: {com: com} %>
                                <% end %>
                            <% end %>
                        </div>
                    </div>
                </div>
            <% if @community_listings.length != 0 %>
                <div class="_view_all right">
                        <%= link_to "View all communities...", communities_path %>
                    </div>
                </div>
            <% end %>
        </div>
<%# -- Top Tracks -------------------------------------------------------------- %>
        <div class="row">
                <div class="col s12">
                <div class="content_title">
                    <i class="material-icons" style="font-size: 35px">graphic_eq</i>Top Tracks
                </div>
                <div class="row">
                    <div class="col m12 s12">
                        <div class="row">
                            <div class="col l4 m12 s12"> 
                                <span class="_title"> Feed </span>

                                <div class="row">
                                    <div class="col s12 content_card z-depth-1" style="padding-left: 2px; padding-right: 2px;">
                                        <ul class="feed_listing">
                                            <table class="bordered highlight">
                                                <% if @feed.length == 0 %>
                                                    <% if @community_listings.length  == 0 %>
                                                        <span class="_diamond">
                                                            There are not any communities stored in the database. The first step should be to
                                                            <%= link_to "create one.", new_community_path %> Then songs can be added.
                                                        <span>
                                                    <% else %>
                                                        <span class="_diamond">
                                                            There are not any songs stored in the database. The next step should be to
                                                            <%= link_to "create one.", new_micropost_path %>
                                                        <span>
                                                    <% end %>

                                                <% else %>
                                                    <%= render @feed %>
                                                <% end %>
                                            </table>
                                        </ul>
                                        <div class="right">
                                            <% if @feed != nil %>
                                                <%= will_paginate @feed %>
                                            <% end %>
                                        </div>
                                        <br>
                                    </div>
                                </div>

                            </div>

                            <div class="col l4 m12 s12"> 
                                <span class="_title"> Listen on Youtube </span>

                                <div class="row">
                                    <div class="col s12 content_card z-depth-1">
                                        <b>Developer note: </b><br>
                                        Alex, here is where your youtube render will 
                                        be displayed
                                    </div>
                                </div>

                            </div>

                            <div class="col l4 m12 s12"> 
                                <span class="_title"> Listen on Spotify</span>

                                <div class="row">
                                    <div class="col s12" style="padding:0px;">
                                        <iframe src="https://open.spotify.com/embed?uri=spotify:user:1224459409:playlist:5EAbXQCZMXMLIsqKdKR25f&theme=white" width="100%" height="585px" frameborder="0" allowtransparency="true" class="z-depth-1" ></iframe>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
        </div>

<%# -- User Info --------------------------------------------------------------- %>
        <% if logged_in? && @posts != nil%>
            <div class="row">
                <div class="col s12">
                    <div class="content_title">
                        <i class="material-icons" style="font-size: 35px">account_box</i>My Content
                    </div>
                    <div class="row">
                        <div class="col m12 s12">
                            <div class="row">
                                <div class="col l4 m12 s12"> 
                                    <span class="_title"> @Title </span>
                                    <div class="row">
                                        <div class="col s12 content_card z-depth-1">
                                            @concent
                                        </div>
                                    </div>
                                </div>

                                <div class="col l4 m12 s12"> 
                                    <span class="_title"> My Posts (<%= current_user.microposts.count %>) </span>
                                    <div class="row">
                                        <div class="col s12 content_card z-depth-1">
                                            <table class="bordered highlight">
                                                <% for micropost in @posts %>
                                                    <tr>
                                                        <td class="fp_song_title"><span class="_nonvoted_trend"><%= micropost.cached_votes_score %> pts</span> <%= link_to micropost.title, micropost %> by <%= micropost.artist %></td>
                                                    </tr>
                                                <% end %>
                                            </table>
                                            <span class="_details_trend right"><%= link_to "More...", current_user %>
                                        </div>

                                    </div>
                                </div>

                                <div class="col l4 m12 s12"> 
                                    <span class="_title"> My Upvoted Songs </span>
                                    <div class="row">
                                        <div class="col s12 content_card z-depth-1">
                                            <table class="bordered highlight">
                                                <% @current = current_user.votes.up.for_type(Micropost) %>
                                                <% for micropost in @current %>
                                                    <tr>
                                                        <td class="fp_song_title">
                                                            <% @find = Micropost.find(micropost.votable_id) %>
                                                            <span class="_nonvoted_trend"><%= @find.cached_votes_score %> pts</span> <%= link_to @find.title, @find %> by <%= @find.artist %>
                                                        </td>
                                                    </tr>
                                                <% end %>
                                            </table>
                                            <span class="_details_trend right"><%= link_to "More...", current_user %>
                                        </div>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        <% end %>
    </div>
</div>